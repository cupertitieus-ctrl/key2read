<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>key2read — Reading comprehension that kids love and teachers trust</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/landing.css">
</head>
<body>

<!-- ===== NAVBAR ===== -->
<nav class="navbar">
  <div class="navbar-inner">
    <a href="index.html" class="navbar-brand">
      <img src="/public/logo.png" alt="key2read" style="height:52px;width:auto">
    </a>
    <div class="navbar-links">
      <a href="#features">Features</a>
      <a href="#how-it-works">How It Works</a>
      <a href="#pricing">Pricing</a>
    </div>
    <div class="navbar-actions" id="navbar-actions">
      <a href="pages/signin.html" class="btn btn-ghost btn-sm">Sign In</a>
      <a href="pages/signup.html" class="btn btn-primary btn-sm">Get Started Free</a>
    </div>
  </div>
</nav>

<!-- ===== HERO ===== -->
<section class="hero">
  <div class="hero-inner">
    <h1>Reading comprehension that kids <span class="gradient-text">love</span> and teachers <span class="gradient-text">trust</span></h1>
    <p>Key Chapter Books go beyond storytelling, they&rsquo;re built to strengthen reading skills and expand vocabulary with additional learning tools.</p>
    <div class="hero-search" id="hero-search">
      <div class="hero-search-input-wrap">
        <svg class="hero-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" id="landing-search-input" placeholder="Search Key Chapter Books by title, author, or genre" autocomplete="off" spellcheck="false">
      </div>
      <div class="hero-search-results" id="hero-search-results"></div>
    </div>
    <p class="hero-browse-link">or <a href="pages/dashboard.html">browse all books</a></p>
  </div>
</section>

<!-- ===== BOOK LIBRARY ===== -->
<section class="library-section" id="library">
  <div class="library-inner">
    <div class="library-header">
      <h2>Pick a Book</h2>
      <p class="library-disclaimer">Each book image opens a corresponding comprehensive quiz. Students must have access to the physical book separately. You can purchase the books <a href="https://www.dianealber.com/pages/keychapterbooks" target="_blank" rel="noopener noreferrer">here</a>.</p>
    </div>
    <div class="library-grid" id="library-grid">
      <!-- Books loaded by JS -->
    </div>
    <div class="library-pagination" id="library-pagination"></div>
  </div>
</section>

<!-- ===== GROWTH BANNER ===== -->
<section class="growth-banner-section">
  <div class="growth-banner-inner">
    <div class="growth-banner-wrap">
      <img src="/public/Growth_Banner empty.jpg" alt="Student Growth" class="growth-banner-img">
      <div class="growth-banner-text">
        <img src="/public/logo.png" alt="key2read" class="growth-banner-logo">
        <h2>Where Physical Reading<br>Meets Measurable<br><span class="growth-highlight">Growth</span></h2>
        <p>Key2Read is designed to support authentic, book-in-hand reading while providing measurable, short, focused quizzes that build vocabulary and strengthen comprehension.</p>
      </div>
    </div>
  </div>
</section>

<!-- ===== HOW IT WORKS ===== -->
<section class="how-section" id="how-it-works">
  <div class="section-header">
    <h2>How It Works</h2>
    <p>Get started in minutes. See results in days.</p>
  </div>
  <div class="how-steps stagger">
    <div class="how-step animate-slide-up">
      <div class="step-number">1</div>
      <h3>Pick a Book</h3>
      <p>Choose a chapter book you're excited about &mdash; funny stories, animals, science, adventure, mystery, and more!</p>
    </div>
    <div class="how-step animate-slide-up">
      <div class="step-number">2</div>
      <h3>Read &amp; Take the Quiz</h3>
      <p>Read your book at home or in class. When you're ready, come back and take a fun quiz to earn Keys and grow your Reading Score.</p>
    </div>
    <div class="how-step animate-slide-up">
      <div class="step-number">3</div>
      <h3>See Your Progress</h3>
      <p>Watch your Reading Score grow! Earn Keys, level up with badges, and see how much your reading skills are improving.</p>
    </div>
  </div>
</section>

<!-- ===== TEACHER DASHBOARD PREVIEW ===== -->
<section class="dashboard-preview-section" style="padding:48px 24px;text-align:center;background:var(--g50,#f9fafb)">
  <div style="max-width:960px;margin:0 auto">
    <h2 style="font-size:1.75rem;font-weight:800;color:var(--navy,#1e293b);margin-bottom:8px">Your Teacher Dashboard</h2>
    <p style="font-size:1rem;color:var(--g400,#6b7280);margin-bottom:24px">Track every student's reading progress, quiz scores, and achievements — all in one place.</p>
    <img src="/public/Teacher_Dashboard_U (1).png" alt="Key2Read Teacher Dashboard" style="width:100%;max-width:900px;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.12)">
  </div>
</section>

<!-- ===== FEATURES ===== -->
<section class="features-section" id="features">
  <div class="section-header">
    <h2>Everything you need to supercharge reading</h2>
    <p>Built for Ages 6&ndash;10 with tools teachers actually want and students genuinely enjoy.</p>
  </div>
  <div class="features-grid stagger">
    <!-- 1: Build Critical Thinking Skills -->
    <div class="feature-card animate-slide-up" onclick="this.classList.toggle('expanded')">
      <div class="feature-icon blue">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
      </div>
      <h3>Build Critical Thinking Skills</h3>
      <p>Each quiz helps students practice problem solving and deeper thinking about what they read.</p>
      <div class="feature-detail">
        <ul>
          <li>5 question types per quiz: literal recall, cause &amp; effect, vocabulary in context, inference, and best-answer reasoning</li>
          <li>Highlighted vocabulary words with tap-to-define give students instant support without leaving the quiz</li>
          <li>Reading strategy hints teach students <em>how</em> to find answers, not just what the answer is</li>
          <li>Personalized questions based on each student&rsquo;s interests increase engagement</li>
        </ul>
      </div>
      <span class="feature-expand-hint">Tap to learn more</span>
    </div>
    <!-- 2: Key Economy -->
    <div class="feature-card animate-slide-up" onclick="this.classList.toggle('expanded')">
      <div class="feature-icon gold">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="8" r="4"/><path d="M10.5 10.5L21 21"/><path d="M16 16l5 0"/><path d="M19 13l0 6"/></svg>
      </div>
      <h3>Key Economy</h3>
      <p>Students earn Keys for passing quizzes and spend them in the Class Store for real rewards.</p>
      <div class="feature-detail">
        <ul>
          <li>Students earn Keys by scoring 80% or higher on chapter quizzes</li>
          <li>Teachers create a custom Class Store with prizes students can purchase using their Keys</li>
          <li>Built-in purchase tracking lets teachers see who bought what and mark prizes as fulfilled</li>
          <li>Drives intrinsic motivation &mdash; students <em>want</em> to read more to earn more Keys</li>
        </ul>
      </div>
      <span class="feature-expand-hint">Tap to learn more</span>
    </div>
    <!-- 3: Real-Time Analytics -->
    <div class="feature-card animate-slide-up" onclick="this.classList.toggle('expanded')">
      <div class="feature-icon green">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
      </div>
      <h3>Real-Time Analytics</h3>
      <p>Track every student's reading score, accuracy, and growth trends on a live teacher dashboard.</p>
      <div class="feature-detail">
        <ul>
          <li>Live dashboard shows class-wide stats: average score, comprehension, Keys earned, quizzes completed</li>
          <li>Individual student reports with reading score history, quiz results, and growth trends</li>
          <li>Reading score distribution chart shows how many students are at each level</li>
          <li>Printable and PDF-exportable reports with your school branding</li>
        </ul>
      </div>
      <span class="feature-expand-hint">Tap to learn more</span>
    </div>
    <!-- 4: Formative Assessments -->
    <div class="feature-card animate-slide-up" onclick="this.classList.toggle('expanded')">
      <div class="feature-icon purple">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      </div>
      <h3>Formative Assessments</h3>
      <p>Assign reading benchmarks and assessments to measure comprehension growth over time.</p>
      <div class="feature-detail">
        <ul>
          <li>Assign specific books and chapters to individual students or the whole class</li>
          <li>Track completion rates and scores for each assignment</li>
          <li>AI-generated quizzes test literal comprehension, vocabulary, inference, and critical thinking</li>
          <li>Immediate feedback helps students learn from mistakes in real time</li>
        </ul>
      </div>
      <span class="feature-expand-hint">Tap to learn more</span>
    </div>
    <!-- 5: Reading Score Algorithm -->
    <div class="feature-card animate-slide-up" onclick="this.classList.toggle('expanded')">
      <div class="feature-icon sky">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>
      </div>
      <h3>Reading Score Algorithm</h3>
      <p>A transparent, multi-factor reading score that accounts for accuracy, growth, and consistency.</p>
      <div class="feature-detail">
        <ul>
          <li>Score from 0&ndash;1000 that combines quiz accuracy, reading effort, vocabulary growth, and persistence</li>
          <li>Students see their score change after every quiz &mdash; creating a clear cause-and-effect loop</li>
          <li>Weekly growth tracking shows improvement over time, not just a snapshot</li>
          <li>Independent reading (using fewer hints) is rewarded with bonus points</li>
        </ul>
      </div>
      <span class="feature-expand-hint">Tap to learn more</span>
    </div>
    <!-- 6: Class Goals & Celebrations -->
    <div class="feature-card animate-slide-up" onclick="this.classList.toggle('expanded')">
      <div class="feature-icon orange">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
      </div>
      <h3>Class Goals &amp; Celebrations</h3>
      <p>Celebrate milestones with badges and achievements. Students stay motivated together.</p>
      <div class="feature-detail">
        <ul>
          <li>Students earn badges for completing books, hitting quiz streaks, and reaching score milestones</li>
          <li>Congratulations popup when a new badge is earned keeps students excited</li>
          <li>Weekly Wins dashboard shows Keys earned, quizzes completed, and books finished this week</li>
          <li>Class-wide popular books chart shows what everyone is reading</li>
        </ul>
      </div>
      <span class="feature-expand-hint">Tap to learn more</span>
    </div>
  </div>
</section>

<!-- ===== STUDENT DASHBOARD PREVIEW ===== -->
<section class="dashboard-preview-section" style="padding:48px 24px;text-align:center;background:#fff">
  <div style="max-width:960px;margin:0 auto">
    <h2 style="font-size:1.75rem;font-weight:800;color:var(--navy,#1e293b);margin-bottom:8px">Your Student Dashboard</h2>
    <p style="font-size:1rem;color:var(--g400,#6b7280);margin-bottom:24px">Students track their reading score, earn keys, collect badges, and watch their progress grow.</p>
    <img src="/public/Student_Dashboard.png" alt="Key2Read Student Dashboard" style="width:100%;max-width:900px;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.12)">
  </div>
</section>

<!-- ===== PRICING ===== -->
<section class="pricing-section" id="pricing">
  <div class="section-header">
    <h2>Simple, transparent pricing</h2>
    <p>Plans for every reader, from homeschool to district-wide.</p>
  </div>
  <div class="pricing-grid stagger">
    <!-- Family -->
    <div class="pricing-card animate-slide-up">
      <div class="pricing-card-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      </div>
      <h3>Family</h3>
      <div class="pricing-subtitle">For Homeschool</div>
      <div class="pricing-price">
        <span class="amount">$5</span>
        <span class="period">/ family / month</span>
      </div>
      <p class="pricing-desc">Everything your homeschool family needs to build confident, independent readers at every grade level.</p>
      <div class="pricing-features">
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Up to 8 children per family</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Reading score tracking &amp; progress reports</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Personalized assessments</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Key economy &amp; rewards store</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Badges &amp; achievements</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Multi-level support (Ages 6&ndash;10)</span>
        </div>
      </div>
      <a href="pages/dashboard.html" class="btn btn-outline w-full">Try Free</a>
    </div>
    <!-- School -->
    <div class="pricing-card popular animate-slide-up">
      <div class="pricing-popular-badge">Most Popular</div>
      <div class="pricing-card-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/><line x1="9" y1="7" x2="15" y2="7"/><line x1="9" y1="11" x2="13" y2="11"/></svg>
      </div>
      <h3>School</h3>
      <div class="pricing-subtitle">For Classrooms &amp; Schools</div>
      <div class="pricing-price">
        <span class="amount">$49.99</span>
        <span class="period">/ classroom / year</span>
      </div>
      <p class="pricing-desc">Full-featured reading platform for classrooms and schools with powerful teacher tools and growth tracking.</p>
      <div class="pricing-features">
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Unlimited students &amp; classes</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Reading score tracking &amp; growth reports</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Smart quiz generation &amp; personalization</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Growth reports for principals</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Formative assessments &amp; teaching tools</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Class Store &amp; Key economy</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Google Classroom integration</span>
        </div>
      </div>
      <a href="pages/dashboard.html" class="btn btn-primary w-full">Try Free</a>
    </div>
    <!-- District -->
    <div class="pricing-card animate-slide-up">
      <div class="pricing-card-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 21h18"/><path d="M5 21V7l8-4v18"/><path d="M19 21V11l-6-4"/><path d="M9 9h1"/><path d="M9 13h1"/><path d="M9 17h1"/></svg>
      </div>
      <h3>District</h3>
      <div class="pricing-subtitle">For Districts &amp; Large Organizations</div>
      <div class="pricing-price">
        <span class="amount">Custom</span>
      </div>
      <p class="pricing-desc">Enterprise-level reading platform with district-wide analytics, admin controls, and dedicated support.</p>
      <div class="pricing-features">
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Everything in School plan</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>District-wide analytics &amp; reporting</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Admin controls &amp; user management</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Dedicated onboarding &amp; support</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Custom integrations &amp; SSO</span>
        </div>
        <div class="pricing-feature">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
          <span>Volume pricing for schools</span>
        </div>
      </div>
      <a href="mailto:support@dianealber.com" class="btn btn-outline w-full">Contact Us for a Quote</a>
    </div>
  </div>
</section>

<!-- ===== CTA ===== -->
<section class="cta-section">
  <div class="cta-box">
    <h2>Ready to transform reading in your home and in the classroom?</h2>
    <p>Join thousands of families, teachers, and districts using key2read to build stronger readers. Start reading now or create an account to save your progress and provide full analytics.</p>
    <a href="pages/signup.html" class="btn btn-gold btn-lg">Get Started Free</a>
  </div>
</section>

<!-- ===== FOOTER ===== -->
<footer class="footer">
  <div class="footer-inner">
    <div class="footer-brand">
      <img src="/public/logo.png" alt="key2read" style="height:44px;width:auto">
    </div>
    <div class="footer-links">
      <a href="#">Privacy</a>
      <a href="#">Terms</a>
      <a href="#">Help</a>
      <a href="#">Blog</a>
    </div>
    <div class="footer-copy">&copy; 2026 key2read. All rights reserved.</div>
  </div>
</footer>

<script src="js/landing-search.js"></script>
<script>
// ─── Auth-aware Navbar ───
async function updateNavbar() {
  try {
    const actions = document.getElementById('navbar-actions');
    if (!actions) return;

    const res = await fetch('/api/auth/me');
    const data = await res.json();

    if (!data.user) {
      // Not signed in — restore default buttons
      actions.innerHTML = `
        <a href="pages/signin.html" class="btn btn-ghost btn-sm">Sign In</a>
        <a href="pages/signup.html" class="btn btn-primary btn-sm">Get Started Free</a>
      `;
      return;
    }

    const user = data.user;
    const displayName = user.name || user.email || 'Account';

    actions.innerHTML = `
      <a href="pages/dashboard.html" class="btn btn-ghost btn-sm">Dashboard</a>
      <div class="navbar-user-menu" id="user-menu">
        <button class="navbar-user-btn" id="user-menu-btn">
          <span class="navbar-user-avatar">${displayName.charAt(0).toUpperCase()}</span>
          <span class="navbar-user-name">${displayName.split(' ')[0]}</span>
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
        </button>
        <div class="navbar-dropdown" id="user-dropdown">
          <a href="pages/dashboard.html?page=teacher-settings" class="navbar-dropdown-item">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            Settings
          </a>
          <button class="navbar-dropdown-item" id="logout-btn">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
            Log Out
          </button>
        </div>
      </div>
    `;

    // Toggle dropdown
    const menuBtn = document.getElementById('user-menu-btn');
    const dropdown = document.getElementById('user-dropdown');
    menuBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      dropdown.classList.toggle('open');
    });
    document.addEventListener('click', () => dropdown.classList.remove('open'));

    // Logout
    document.getElementById('logout-btn').addEventListener('click', async () => {
      await fetch('/api/auth/logout', { method: 'POST' });
      window.location.reload();
    });
  } catch(e) { /* Server may not be running */ }
}

// Run on initial load
updateNavbar();

// Re-run when returning via back/forward (bfcache restore)
window.addEventListener('pageshow', function(e) {
  if (e.persisted) updateNavbar();
});
</script>

<style>
/* ─── Navbar User Menu ─── */
.navbar-user-menu { position: relative; }
.navbar-user-btn {
  display: flex; align-items: center; gap: 8px;
  background: none; border: 1px solid var(--g200); border-radius: 999px;
  padding: 4px 12px 4px 4px; cursor: pointer; font-family: var(--font-body);
  font-size: 0.875rem; color: var(--g700); transition: all .15s;
}
.navbar-user-btn:hover { border-color: var(--blue); background: var(--blue-p); }
.navbar-user-avatar {
  width: 28px; height: 28px; border-radius: 50%;
  background: linear-gradient(135deg, var(--blue), var(--purple));
  color: #fff; display: flex; align-items: center; justify-content: center;
  font-weight: 600; font-size: 0.75rem;
}
.navbar-user-name { font-weight: 500; }
.navbar-dropdown {
  position: absolute; right: 0; top: calc(100% + 8px);
  background: #fff; border: 1px solid var(--g200); border-radius: 12px;
  box-shadow: var(--sh-lg); min-width: 180px; padding: 6px;
  opacity: 0; visibility: hidden; transform: translateY(-4px);
  transition: all .15s ease;
  z-index: 100;
}
.navbar-dropdown.open { opacity: 1; visibility: visible; transform: translateY(0); }
.navbar-dropdown-item {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 14px; border-radius: 8px; font-size: 0.875rem;
  color: var(--g700); text-decoration: none; cursor: pointer;
  background: none; border: none; width: 100%; font-family: var(--font-body);
  transition: background .1s;
}
.navbar-dropdown-item:hover { background: var(--g50); color: var(--g900); }
.navbar-dropdown-item svg { flex-shrink: 0; opacity: .6; }
</style>
</body>
</html>
